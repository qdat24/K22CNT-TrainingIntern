<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi ti·∫øt ƒë∆°n h√†ng</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
/* ========= Root & Reset ========= */
:root{
  --bg:#f6f8fb;
  --card:#ffffff;
  --text:#2c3e50;
  --muted:#7f8c8d;
  --primary:#2d72d9;
  --primary-600:#1f5fb9;
  --danger:#e74c3c;
  --success:#27ae60;
  --warning:#f4c150;
  --shadow:0 8px 24px rgba(31,45,61,.08);
  --radius:14px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font: 500 15px/1.6 ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  color:var(--text); background:var(--bg);
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}

/* ========= Typography ========= */
h1,h2,h3{margin:0 0 .6rem 0; letter-spacing:.2px}
h2{
  display:flex; align-items:center; gap:10px;
  font-size:1.25rem; color:var(--text);
}
h2 i{opacity:.9}

/* ========= Generic Card polish ========= */
div[style*="background: white"][style*="box-shadow"]{
  border-radius:var(--radius) !important;
  box-shadow:var(--shadow) !important;
  border:1px solid rgba(44,62,80,.06);
  transition: transform .18s ease, box-shadow .18s ease;
  backdrop-filter:saturate(120%) blur(2px);
}
div[style*="background: white"][style*="box-shadow"]:hover{
  transform: translateY(-2px);
  box-shadow:0 14px 32px rgba(31,45,61,.12) !important;
}

/* ========= Tables ========= */
table{width:100%; border-collapse:separate; border-spacing:0 10px}
td{
  vertical-align:top; padding:6px 0;
}
td:first-child{
  color:var(--text); font-weight:700; width:200px;
}
td:last-child{color:#33475b}

/* ========= Product list rows ========= */
div[style*="border-bottom: 1px solid #e0e0e0;"][style*="padding: 20px 0"]{
  transition: background .15s ease;
}
div[style*="border-bottom: 1px solid #e0e0e0;"][style*="padding: 20px 0"]:hover{
  background:#fafbfe;
  border-radius:10px;
  padding:20px;
}

/* ========= Totals ========= */
div[style*="T·ªïng c·ªông:"]{font-weight:700}
div[style*="font-size: 1.3rem"] span:last-child{
  font-size:1.4rem !important;
  color:var(--danger) !important;
}

/* ========= Buttons ========= */
.btn{
  display:inline-flex; align-items:center; justify-content:center; gap:8px;
  padding:12px 16px; border-radius:12px; border:1px solid transparent;
  font-weight:700; cursor:pointer; text-decoration:none;
  background:#eef3ff; color:var(--primary);
  transition: background .15s ease, transform .1s ease, box-shadow .15s ease;
  box-shadow:0 4px 12px rgba(45,114,217,.15);
}
.btn:hover{background:#e4ecff; transform: translateY(-1px)}
.btn:active{transform: translateY(0)}
.btn-primary{background:var(--primary); color:#fff; border-color:transparent}
.btn-primary:hover{background:var(--primary-600)}
button.btn[style*="background: #e74c3c"]{
  background:var(--danger) !important; border-color:transparent;
  box-shadow:0 4px 12px rgba(231,76,60,.18);
}
button.btn[style*="background: #e74c3c"]:hover{filter:brightness(.95)}

/* ========= Status chips ========= */
div[style*="border-radius: 8px; text-align: center; font-weight: 600"]{
  text-transform:uppercase; letter-spacing:.4px;
  border:1px dashed rgba(0,0,0,.06);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.6);
}

/* ========= Sticky sidebar ========= */
div[style*="position: sticky"]{
  top: 24px !important;
}

/* ========= Responsive ========= */
@media (max-width: 980px){
  div[style*="display: grid"][style*="grid-template-columns: 2fr 1fr"]{
    grid-template-columns: 1fr !important;
    gap:16px !important;
  }
  h2{font-size:1.15rem}
}

/* ========= Print-friendly ========= */
@media print{
  body{background:#fff}
  div[style*="background: white"][style*="box-shadow"]{box-shadow:none !important; border-color:#ddd}
  .btn{display:none !important}
}
</style>
</head>

<body>
<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px; padding:30px;">

    <!-- Chi ti·∫øt ƒë∆°n h√†ng -->
    <div>
        <!-- Th√¥ng tin giao h√†ng -->
        <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px;">
            <h2><i class="fas fa-shipping-fast"></i> Th√¥ng Tin Giao H√†ng</h2>
            <table>
                <tr><td>Ng∆∞·ªùi nh·∫≠n:</td><td>{{ order.customer_name }}</td></tr>
                <tr><td>S·ªë ƒëi·ªán tho·∫°i:</td><td>{{ order.phone }}</td></tr>
                <tr><td>Email:</td><td>{{ order.email if order.email else 'Kh√¥ng c√≥' }}</td></tr>
                <tr><td>ƒê·ªãa ch·ªâ:</td><td>{{ order.address }}</td></tr>
                {% if order.note %}
                <tr><td>Ghi ch√∫:</td><td>{{ order.note }}</td></tr>
                {% endif %}
            </table>
        </div>

        <!-- S·∫£n ph·∫©m -->
        <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h2><i class="fas fa-shopping-bag"></i> S·∫£n Ph·∫©m ƒê√£ ƒê·∫∑t</h2>
            {% for item in order['items'] %}
            <div style="display: flex; gap: 20px; padding: 20px 0; border-bottom: 1px solid #e0e0e0;">
                <div style="flex: 1;">
                    <h3 style="margin: 0 0 10px 0;">{{ item.product_name }}</h3>
                    <div style="color: #7f8c8d;">ƒê∆°n gi√°: <strong>{{ "{:,.0f}".format(item.price) }} ‚Ç´</strong></div>
                    <div style="color: #7f8c8d;">S·ªë l∆∞·ª£ng: <strong>{{ item.quantity }}</strong></div>
                </div>
                <div style="text-align: right; font-weight: 600; color: #e74c3c;">
                    {{ "{:,.0f}".format(item.subtotal) }} ‚Ç´
                </div>
            </div>
            {% endfor %}

            <!-- T·ªïng c·ªông -->
            <div style="padding: 20px 0; border-bottom: 1px solid #e0e0e0;">
                <div style="display: flex; justify-content: space-between;">
                    <span>T·∫°m t√≠nh:</span><span style="font-weight: 600;">{{ "{:,.0f}".format(order.subtotal) }} ‚Ç´</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Ph√≠ v·∫≠n chuy·ªÉn:</span>
                    <span style="font-weight: 600;">
                        {% if order.shipping_fee == 0 %}
                            <span style="color: #27ae60;">Mi·ªÖn ph√≠</span>
                        {% else %}
                            {{ "{:,.0f}".format(order.shipping_fee) }} ‚Ç´
                        {% endif %}
                    </span>
                </div>
            </div>
            <div style="display: flex; justify-content: space-between; padding: 20px 0; font-size: 1.3rem;">
                <span style="font-weight: 600;">T·ªïng c·ªông:</span>
                <span style="font-weight: 700; color: #e74c3c;">{{ "{:,.0f}".format(order.total) }} ‚Ç´</span>
            </div>
        </div>
    </div>

    <!-- C·ªôt ph·∫£i -->
    <div>
        <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top: 100px;">
            <h2><i class="fas fa-info-circle"></i> Tr·∫°ng Th√°i ƒê∆°n H√†ng</h2>

            <div style="margin-bottom: 20px;">
                <div style="font-weight: 600;">Ng√†y ƒë·∫∑t h√†ng:</div>
                <div style="color: #7f8c8d;">{{ order.created_at.strftime('%d/%m/%Y %H:%M:%S') if order.created_at else 'N/A' }}</div>
            </div>

            <div style="margin-bottom: 20px;">
                <div style="font-weight: 600;">Ph∆∞∆°ng th·ª©c thanh to√°n:</div>
                <div style="color: #7f8c8d;">
                    {% if order.payment_method == 'cod' %}
                        üíµ Thanh to√°n khi nh·∫≠n h√†ng (COD)
                    {% elif order.payment_method == 'bank_transfer' %}
                        üè¶ Chuy·ªÉn kho·∫£n ng√¢n h√†ng
                    {% elif order.payment_method == 'credit_card' %}
                        üí≥ Th·∫ª t√≠n d·ª•ng
                    {% else %}
                        {{ order.payment_method }}
                    {% endif %}
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <div style="font-weight: 600;">Tr·∫°ng th√°i ƒë∆°n h√†ng:</div>
                <div style="padding: 15px; border-radius: 8px; text-align: center; font-weight: 600;
                    {% if order.status == 'pending' %}background: #fff3cd; color: #856404;
                    {% elif order.status == 'confirmed' %}background: #d1ecf1; color: #0c5460;
                    {% elif order.status == 'shipping' %}background: #e2d9f3; color: #5a3d7e;
                    {% elif order.status == 'completed' %}background: #d4edda; color: #155724;
                    {% elif order.status == 'cancelled' %}background: #f8d7da; color: #721c24;
                    {% endif %}">
                    {% if order.status == 'pending' %}‚è≥ Ch·ªù x·ª≠ l√Ω
                    {% elif order.status == 'confirmed' %}‚úì ƒê√£ x√°c nh·∫≠n
                    {% elif order.status == 'shipping' %}üöö ƒêang giao h√†ng
                    {% elif order.status == 'completed' %}‚úì Ho√†n th√†nh
                    {% elif order.status == 'cancelled' %}‚úó ƒê√£ h·ªßy
                    {% endif %}
                </div>
            </div>

            <div style="margin-bottom: 25px;">
                <div style="font-weight: 600;">Tr·∫°ng th√°i thanh to√°n:</div>
                <div style="padding: 12px; border-radius: 8px; text-align: center; font-weight: 600;
                    {% if order.payment_status == 'pending' %}background: #fff3cd; color: #856404;
                    {% elif order.payment_status == 'paid' %}background: #d4edda; color: #155724;
                    {% endif %}">
                    {% if order.payment_status == 'pending' %}‚è≥ Ch∆∞a thanh to√°n
                    {% elif order.payment_status == 'paid' %}‚úì ƒê√£ thanh to√°n
                    {% endif %}
                </div>
            </div>

            {% if order.status == 'pending' %}
            <form method="POST" action="{{ url_for('customer_cancel_order', order_id=order.order_id) }}" onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën h·ªßy ƒë∆°n h√†ng n√†y?')">
                <button type="submit" class="btn" style="width: 100%; background: #e74c3c; color: white; padding: 15px; font-size: 1.1rem; margin-bottom: 10px;">
                    <i class="fas fa-times-circle"></i> H·ªßy ƒê∆°n H√†ng
                </button>
            </form>
            {% endif %}

            <a href="{{ url_for('customer_account') }}" class="btn btn-primary" style="width: 100%; text-align: center; padding: 12px;">
                <i class="fas fa-arrow-left"></i> Quay L·∫°i T√†i Kho·∫£n
            </a>
        </div>
    </div>
</div>
</body>
</html>
