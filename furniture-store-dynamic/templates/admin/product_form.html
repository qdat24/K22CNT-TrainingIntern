{% extends "admin/base.html" %}

{% block title %}{% if action == 'add' %}Th√™m S·∫£n Ph·∫©m{% else %}S·ª≠a S·∫£n Ph·∫©m{% endif %}{% endblock %}

{% block content %}
<div class="page-header">
    <h1>{% if action == 'add' %}‚ûï Th√™m S·∫£n Ph·∫©m M·ªõi{% else %}‚úèÔ∏è S·ª≠a S·∫£n Ph·∫©m{% endif %}</h1>
    <p>ƒêi·ªÅn th√¥ng tin s·∫£n ph·∫©m</p>
</div>

<div class="card">
    <form method="POST" action="{% if action == 'add' %}{{ url_for('admin_add_product') }}{% else %}{{ url_for('admin_edit_product', product_id=product.id) }}{% endif %}">
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
            <div style="grid-column: 1 / -1;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">T√™n S·∫£n Ph·∫©m *</label>
                <input type="text" name="name" value="{{ product.name if product else '' }}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
            </div>

            <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">Danh M·ª•c *</label>
                <select name="category" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
                    <option value="">-- Ch·ªçn danh m·ª•c --</option>
                    {% for cat in categories %}
                    <option value="{{ cat }}" {% if product and product.category == cat %}selected{% endif %}>{{ cat }}</option>
                    {% endfor %}
                </select>
            </div>

            <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">Gi√° B√°n (VNƒê) *</label>
                <input type="number" name="price" value="{{ product.price if product else '' }}" required min="0" step="1000" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
            </div>

            <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">Gi√° G·ªëc (VNƒê) *</label>
                <input type="number" name="original_price" value="{{ product.original_price if product else '' }}" required min="0" step="1000" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
            </div>

            <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">ƒê√°nh Gi√° (1-5)</label>
                <input type="number" name="rating" value="{{ product.rating if product else '5.0' }}" min="1" max="5" step="0.1" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
            </div>

            <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">S·ªë L∆∞·ª£t ƒê√°nh Gi√°</label>
                <input type="number" name="reviews" value="{{ product.reviews if product else '0' }}" min="0" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
            </div>

            <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">S·ªë L∆∞·ª£ng T·ªìn Kho</label>
                <input type="number" name="stock" value="{{ product.stock if product else '100' }}" min="0" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
            </div>

            {% if action == 'edit' %}
            <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">Tr·∫°ng Th√°i</label>
                <label style="display: flex; align-items: center; gap: 10px; padding: 10px;">
                    <input type="checkbox" name="is_active" {% if product and product.is_active %}checked{% endif %} style="width: 20px; height: 20px;">
                    <span>Ho·∫°t ƒë·ªông (hi·ªÉn th·ªã tr√™n website)</span>
                </label>
            </div>
            {% endif %}

            <div style="grid-column: 1 / -1;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">URL H√¨nh ·∫¢nh</label>
                <input type="url" name="image" value="{{ product.image if product else '' }}" placeholder="https://example.com/image.jpg" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
                <small style="color: #666; font-size: 12px;">D√°n link h√¨nh ·∫£nh t·ª´ Unsplash ho·∫∑c ngu·ªìn kh√°c</small>
            </div>

            <div style="grid-column: 1 / -1;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">M√¥ T·∫£ S·∫£n Ph·∫©m</label>
                <textarea name="description" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">{{ product.description if product else '' }}</textarea>
            </div>

            <div style="grid-column: 1 / -1;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">T√≠nh NƒÉng (m·ªói d√≤ng 1 t√≠nh nƒÉng)</label>
                <textarea name="features" rows="5" placeholder="Ch·∫•t li·ªáu g·ªó s·ªìi t·ª± nhi√™n&#10;Thi·∫øt k·∫ø hi·ªán ƒë·∫°i&#10;B·∫£o h√†nh 2 nƒÉm" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">{% if product and product.features %}{{ product.features|join('\n') }}{% endif %}</textarea>
                <small style="color: #666; font-size: 12px;">M·ªói t√≠nh nƒÉng tr√™n m·ªôt d√≤ng ri√™ng</small>
            </div>
        </div>

        <div style="margin-top: 30px; display: flex; gap: 10px;">
            <button type="submit" class="btn btn-success">üíæ L∆∞u S·∫£n Ph·∫©m</button>
            <a href="{{ url_for('admin_products') }}" class="btn btn-danger">‚ùå H·ªßy</a>
        </div>
    </form>
</div>

{% if product and product.image %}
<div class="card" style="margin-top: 20px;">
    <div class="card-header">
        <h3>Xem Tr∆∞·ªõc H√¨nh ·∫¢nh</h3>
    </div>
    <div style="text-align: center;">
        <img src="{{ product.image }}" alt="{{ product.name }}" style="max-width: 100%; max-height: 400px; object-fit: contain; border-radius: 10px;">
    </div>
</div>
{% endif %}
{% endblock %}
